0장. 기술: 와이어샤크 핵심 요소와 트래픽 흐름
0.1 와이어샤크의 핵심 기능 이해
일반 분석 작업
문제점 해결 작업
보안 분석 (네트워크 포렌식) 작업
애플리케이션 분석 작업
0.2 정확한 와이어샤크 버전 확보
0.3 와이어샤크가 트래픽을 수집하는 방법
수집 프로세스는 특수 링크 계층 드라이버에 의존한다
Dumpcap 수집 엔진은 정지 조건을 지정한다
코어 엔진은 가장 중요하다
QT 프레임워크는 사용자 인터페이스를 제공한다
GTK+ 툴킷은 단계적으로 중지될 것이다
Wiretap 라이브러리는 저장된 추적 파일을 읽는 데 사용된다
0.4 전형적인 와이어샤크 분석 세션 이해
0.5 프레임과 패킷 구분
프레임 인식
패킷 인식
세그먼트 인식
0.6 네트워크를 지나가는 패킷 따라가기 HTTP
포인트 1: 클라이언트에서 무엇을 볼 것인가?
포인트 2: 첫째 스위치의 뒤쪽에서 무엇을 볼 수 있는가?
포인트 3: 라우터의 다른 쪽에서 무엇을 볼 수 있는가?
포인트 4: 라우터/NAT 장치의 다른 쪽에서 무엇을 볼 수 있는가?
포인트 5: 서버에서 무엇을 볼 것인가?
트래픽을 어디에서 수집할 것인가
기본적인 스위치의 전달 기능을 인지하라
0.7 와이어샤크 자원 접근
와이어샤크 위키 프로토콜 페이지를 활용하라
ask.wireshark.org에서 질문에 대한 답을 얻는다
0.8 메인 와이어샤크 뷰를 활용한 트래픽 분석
추적 파일(메인 툴바를 사용해 꼭)을 열어라
스파크라인을 이용해 수집 시작
언제 메인 메뉴를 사용해야 하는지 알아야 한다
가능할 때마다 메인 툴바를 사용하는 방법 배우기
단축키 배우기
필터 툴바 정복
패킷 목록 창을 활용해 트래픽 요약
패킷 상세 창 안으로 깊이 들어가 보자
패킷 바이트 창에서 컴퓨터 언어를 보게 된다
상태 바에 주의를 기울이자
실습 1: 네트워크 구성도를 완성하려면 패킷을 이용하라
0.9 전형적인 네트워크 트래픽 분석
웹 브라우징 트래픽 분석
실습 2:사용자 자신의 백그라운드 트래픽 수집과 분류
0.10 다른 도구에서 수집된 추적 파일 열기
실습 3: 네트워크 모니터 .cap 파일 열기
도전 과제


1장. 기술: 와이어샤크 뷰와 설정 맞춤화
1.1 패킷 목록 화면에 열 추가
오른쪽 클릭 > Apply as Column(쉬운 방법)
Edit > Preferences > Columns (어려운 방법)
열의 숨김, 삭제, 재배열, 편집
열 내용 정렬
열 데이터 내보내기
실습 4: 열에 HTTP 호스트 필드 추가
1.2 와이어샤크 분석기 분석
프레임 분석기
이더넷 분석기 역할
IPv4 분석기 역할
TCP 분석기 역할
HTTP 분석기 역할
1.3 비표준 포트 번호를 사용하는 트래픽 분석
비표준 포트를 사용하면 일어나는 일
경험적 분석기가 작동하는 방식
트래픽에 대해 수동으로 분석기 강제 적용
애플리케이션 선호도 설정을 이용한 분석 조절 (가능하다면)
1.4 특정 트래픽 유형을 디스플레이하는 방법 변경
사용자 인터페이스 설정 지정
캡처 설정 적용
Filter Expression 버튼 지정
이름 변환 설정 지정
프로토콜과 애플리케이션 설정 지정
실습 5: 핵심 와이어샤크 선호도(중요한 실습) 설정하기
1.5 서로 다른 작업(프로파일)을 위해 와이어샤크 꾸미기
프로파일의 기본 사항
새로운 프로파일 생성
실습 6: 디폴트 프로파일을 기반으로 신규 프로파일 생성
1.6 핵심 와이어샤크 구성 파일 위치 알아내기
글로벌 구성 디렉터리
개인 구성(프로파일) 디렉터리
실습 7: DNS/HTTP Errors 프로파일 불러오기
1.7 Time 열을 구성해 지연 문제점 찾아내기
경로 대기 시간 표시와 원인
클라이언트 전달 지연 표시와 원인
서버 전달 지연 표시와 원인
Time 열 설정을 변경으로 전달 지연 문제점 검출
새로운 TCP Delta 열로 전달 지연 문제점 탐지
신경 쓰지 마라: 약간의 지연은 정상이다
실습 8: 경로와 서버 전달 지연 문제에 집중하라
도전 과제


2장. 기술: 최선의 수집 방법 결정과 수집 필터 적용
2.1 브라우징이나 파일 다운로드가 늦는 문제를 해결하기 위한 최선의 수집 위치 확인
이상적인 시작 포인트
필요하다면 옮겨라
2.2 이더넷 네트워크 트래픽 수집
2.3 무선 네트워크 트래픽 수집
본래의 WLAN 어댑터가 볼 수 있는 것은 무엇인가?
완전한 WLAN을 보려면 AirPcap 어댑터를 사용하라
WLAN/Loopback 가시성을 위해 Npcap 드라이버 사용
2.4 동작 중인 인터페이스 파악
어느 어댑터가 트래픽을 보는지 지정
복수 어댑터 수집의 사용을 고려하라
2.5 대량의 트래픽 처리
많은 트래픽을 살펴봐야 하는 이유
수집 필터를 사용하는 가장 큰 이유
파일 집합으로 수집
파일 집합에서 열고 이동
다른 해결책을 고려하라: SteelCentral™ 패킷 분석기
실습 9: 파일 집합으로 수집
2.6 특수 수집 기술을 사용해 산발적인 문제 해결
파일 집합과 링 버퍼 사용
불평이 생기면 중단하라
실습 10: 링 버퍼를 사용해 드라이브 공간을 절약하라
2.7 작업해야 할 트래픽 총량을 줄여라
와이어샤크가 감당하지 못할 때를 감지한다
확장된 스위치가 감당하지 못할 때를 감지한다
Capture Options 창에서 수집 필터 적용
2.8 주소 기반의 트래픽 수집 (MAC/IP)
특정 IP주소에서/로 오는 트래픽 수집
IP 주소 범위에서/로 오는 트래픽 수집
브로드캐스트 또는 멀티캐스트 트래픽 수집
MAC 주소 기반의 트래픽 수집
실습 11: 자신의 IP 주소에서/로 오는 트래픽만 수집
실습 12: 자신을 제외한 모든 MAC 주소에서/로 오는 트래픽만 수집
2.9 특정 애플리케이션에 대한 트래픽 수집
이것은 포트 번호에 대한 모든 것이다
포트 기반 수집 필터 결합
2.10 특정 ICMP 트래픽 수집
실습 13: DNS 수집 필터 생성과 저장 및 적용
도전 과제


3장. 기술: 특정 트래픽을 위한 디스플레이 필터 적용
3.1 적절한 디스플레이 필터 문법 사용
가장 간단한 디스플레이 필터의 문법
디스플레이 필터 오류 탐지 메커니즘 사용
필드 이름을 알게 된다
자동 완성 기능을 사용해 디스플레이 필터 구축
디스플레이 필터와 연산자 비교
표현식을 사용한 디스플레이 필터 구축
실습 14: 자동 완성을 이용해 특정 HTTP 서버에 대한 트래픽 찾기
3.2 디폴트 디스플레이 필터 편집과 사용
실습 15: 새로운 필터를 위한 '표본'으로 디폴트 필터 사용
3.3 HTTP 트래픽의 적절한 필터링
TCP 포트 번호 기반으로 애플리케이션 필터 시험
TCP 기반 애플리케이션 이름 필터를 사용할 때 조심하라
실습 16: 정확한 방법으로 HTTP 트래픽 필터링
3.4 dhcp 디스플레이 필터가 동작하지 않는 이유
3.5 IP주소, 주소 범위, 서브넷 기반으로 디스플레이 필터 적용
단순 IP 주소 호스트에게/부터의 트래픽 필터링
주소 범위에게/부터의 트래픽 필터링
IP 서브넷에서/으로부터 트래픽 필터링
실습 17: 온라인 백업 서브넷에서/으로부터의 트래픽 필터링
3.6 패킷 안에 있는 필드를 이용한 빠른 필터링
빠르게 작업하기: 오른쪽 클릭 후 Apply as Filter를 사용한다
오른쪽 클릭 후 Prepare a Filter로 만들어라
‘…’ 필터 강화를 사용하려면 한 번 더 오른쪽 클릭한다
실습 18: DNS Name Errors나 HTTP 404 Responses 필터링
3.7 단일 TCP나 UDP 대화 필터링
오른쪽 클릭으로 대화 필터링
오른쪽 클릭으로 스트림 따라가기
와이어샤크 통계에서 대화 필터링
스트림 인덱스 필드를 기반으로 대화 필터링 TCP
실습 19: 기동 시에 백그라운드 파일 전송 탐지
3.8 다중 포함/배제 조건으로 디스플레이 필터 확장
논리 연산자 사용
ip.addr != 필터가 동작하지 않는이유
!tcp.flags.syn==1 필터가 동작하지 않는 이유
3.9 괄호를 사용해 필터 의미 변경
실습 20: 클라이언트로의 TCP 연결 시도 횟수 계산
3.10 디스플레이 필터 영역이 황색인 이유
적색 배경: 문법 검사 실패
녹색 배경: 문법 검사 통과
황색 배경: 문법 검사는 통과했지만 경고(!=)가 있다
3.11 추적 파일 안의 주제어로 필터링
전체 프레임에서 단순 주제어 필터 안에 contains를 사용한다
필드 기반의 단순 주제어 필터 안에 contains를 사용한다
대문자 또는 소문자를 찾으려면 주제어 필터 안에 matches and (?i)를 사용한다
복수 단어 검색을 위해 matches를 사용한다
실험 21: 추적 파일 안의 주제어 집합을 찾는 필터
3.12 디스플레이 필터에 와일드카드 사용
‘.’ 로 정규 표현식 사용
반복되는 와일드카드 문자 검색에서 변수 길이 설정
실습 22: 단어 사이를 와일드카드로 필터링
3.13 통신 지연에 집중하기 위한 필터 사용
큰 델타 시간(frame.timedelta)으로 필터링
큰 TCP 델타 시간(tcp.timedelta)으로 필터링
실습 23: 디스플레이 필터를 프로파일로 가져오기
3.14 핵심 디스플레이 필터를 버튼으로 변경
필터 표현식 버튼 생성
필터 표현식 버튼 편집, 재정렬, 삭제, 비활성화
preferences 파일 안의 필터 표현식 영역 편집
실습 24: HTTP 필터 표현식 버튼 생성과 불러오기
도전 과제


4장. 기술: 컬러링과 관심 있는 패킷 내보내기
4.1 적용된 컬러링 규칙 확인
실습 25: 사용 중인 디스플레이 컬러링 규칙에 열 추가
4.2 검사합 오류 컬러링 규칙 해제
개별 컬러링 규칙 비활성화
모든 패킷 컬러링 비활성화
4.3 Highlight Delays에 컬러링 규칙 적용
최초로 컬러링 규칙 생성
컬러링 규칙 생성에 오른쪽 클릭 방법 사용
실습 26: FTP 사용자 이름 패스워드 등을 하이라이트하기 위한 컬러링 규칙 설정
4.4 단일 대화의 신속한 컬러링
오른쪽 클릭으로 대화 임시 컬러링
임시 컬러링 삭제
실습 27: 임시 대화 컬러링 규칙 생성
4.5 지능형 스크롤바 마스터
지능형 스크롤바에서 수동으로 탐색
지능형 스크롤바 메뉴 탐색
실습 28: 문제점을 빨리 찾기 위한 지능형 스크롤바 이용
4.6 관심 있는 패킷 내보내기
실습 29: 단일 TCP 대화 내보내기
4.7 패킷 상세 정보 내보내기
패킷 분석 내보내기
무엇을 내보낼지 지정하라
텍스트 출력 예
CSV 출력 예
실습 30: 추적 파일에서 HTTP Host 필드 값 목록 내보내기
도전 과제


5장 기술: 표와 그래프 작성과 해석
5.1 네트워크에서 대화 중인 사람 찾기
네트워크 대화 확인
대화의 신속한 필터링
5.2 최다 대화자 찾기
가장 활동적인 대화를 찾기 위한 정렬
가장 활발한 호스트를 찾기 위한 정렬
실습 31: 가장 활동적인 TCP 대화 필터링
실습 32: 글로벌 지도에 목표물을 표시하기 위한 GeoIP 설정
5.3 네트워크상 보이는 애플리케이션 나열
프로토콜 계층 구조 살펴보기
오른쪽 클릭으로 나열된 프로토콜과 애플리케이션의 필터링과 컬러링
의심되는 프로토콜, 애플리케이션 또는 '데이터' 찾기
실습 33: 의심스런 프로토콜이나 애플리케이션 탐지
5.4 그래프 응용과 호스트 대역폭 사용
그래프화하기 전에 애플리케이션이나 호스트 트래픽 내보내기
IO Graph에 ip.addr 디스플레이 필터 적용
IO 그래프에 ip.src 디스플레이 필터 적용
IO Graph에 tcp.port나 udp.port디스플레이 필터 적용
실습 34: 서브넷상 트래픽과 다른 트래픽 비교
5.5 네트워크상 오류 탐지 TCP
상태 바의 Expert Infos 버튼 이용
Expert의 심각도 수준 살펴보기
TCP 분석 플래그 패킷 필터링
5.6 Expert Information Errors의 의미
패킷 손실, 복구 및 결함 추적 파일
비동기 및 다중 경로 경보
Keep-Alive 경보
버퍼 혼잡 경보 수신
TCP 연결 포트 재사용 경보
라우터 문제 가능성 경보
설정 오류나 ARP 포이즈닝 경보
실습 35: 오버로드된 클라이언트 구별
5.7 다양한 네트워크 오류 그래프
모든 TCP 분석 플래그 패킷 그래프로 그리기(윈도우 업데이트 제외)
TCP 분석 플래그 패킷 개별 유형 그래프
실습 36: 파일 전송 문제 탐지와 그래프로 나타내기
도전 과제


6장. 기술: 빠른 분석을 위한 트래픽 재조립
6.1 웹 브라우징 세션 재조립
Follow | TCP Stream 사용
Stream에 Find, Save, Filter 사용
실습 37: 재조립을 사용해서 웹사이트의 감춰진 HTTP 메시지 찾기
6.2 FTP로 전송된 파일 재조립
실습 38: FTP 파일 전송에서 파일 추출
6.3 웹 브라우징 세션에서 전송된 HTTP 객체 내보내기
TCP Preference 설정 확인
추적 파일에 있는 모든 HTTP 객체 살펴보기
실습 39: 웹 브라우징 세션에서 HTTP 객체 찾기
도전 과제


7장. 기술: 추적 파일과 패킷에 주석 추가
7.1 추적 파일에 주석 추가
7.2 개별 패킷에 자신의 주석 추가
주석에 .pcapng 형식 사용
빠른 보기를 위한 Comment 열 추가
실습 40: 악성 재지정 추적 파일 안의 분석 주의 읽기
7.3 보고서로 패킷 주석 내보내기
주석을 포함하고 있는 패킷 필터링
패킷 해석을 평문으로 내보내기
실습 41: 악성 재지정 패킷 주석 내보내기
도전 과제


8장. 기술: 커맨드라인 도구로 트래픽 수집, 분리, 통합
8.1 대규모 추적 파일을 파일 집합으로 분리
자신의 경로에 와이어샤크 프로그램 디렉터리 추가
Capinfos로 파일 크기와 패킷 번호를 얻기
추적 파일당 패킷에 기반을 둔 파일 분리
추적 파일당 초수에 근거한 파일 분리
와이어샤크에서 파일 집합을 열고 작업
실습 42: 파일 분리와 필터링된 파일 집합으로 작업
8.2 여러 추적 파일 통합
와이어샤크 프로그램 디렉터리가 경로에 존재함을 보증
-w 매개변수로 Mergecap을 실행
실습 43: 와일드카드를 이용한 파일 집합 통합
8.3 커맨드라인에서 트래픽 수집
Dumpcap인가 Tshark인가?
Dumpcap으로 커맨드라인에서 수집
Tshark로 커맨드라인에서 수집
호스트 정보 저장과 기존 추적 파일로 작업
실습 44: Tshark로 자동 정지가 설정된 파일 집합 수집
8.4 커맨드라인 수집 과정에 수집 필터 사용
8.5 커맨드라인 수집 과정에 디스플레이 필터 사용
실습 45: Tshark로 HTTP GET 요청 추출
8.6 Tshark로 특정 필드 값과 추적 파일의 통계 자료 내보내기
필드 값 내보내기
트래픽 통계 자료 내보내기
HTTP 호스트 필드 값 내보내기
실습 46: Tshark로 HTTP Host 이름과 IP 주소 추출
8.7 와이어샤크와 네트워크 분석 계속해서 배우기
도전 과제


부록 A 도전 과제 해답
부록 B 추적 파일 설명
네트워크 분석 용어 사전